{"version":3,"sources":["../../../../src/components/items/decorators/withDnD.js"],"names":["HAS_TOUCH","has","DELTA","MARK_REMOVE","REMOVE_ITEM","REMOVE_UNDER","_getTouchesClientX","ev","touches","clientX","_getChangedTouches","changedTouches","_dragStart","persist","dragStartWithDnDStyle","dataTransfer","effectAllowed","dropEffect","_onTouchStart","_clientX","_onTouchMove","Math","abs","_dragEnd","preventDefault","dragEndWithDnDStyle","_deltaX","props","item","onRemoveUnder","_handleClose","_onTouchEnd","_preventDefault","_crDnDHandlers","onTouchStart","bind","onTouchMove","onTouchEnd","draggable","onDragStart","onDragEnd","onDrop","onDragOver","onDragEnter","onDragLeave","withDnD","target","Object","assign","prototype"],"mappings":"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","sourcesContent":["import has from '../../has'\r\nimport withDnDStyle from './withDnDStyle'\r\n\r\nconst { HAS_TOUCH } = has\r\n, DELTA = HAS_TOUCH ? {\r\n    MARK_REMOVE: 50,\r\n    REMOVE_ITEM: 90,\r\n    REMOVE_UNDER: 150\r\n  } : {\r\n    MARK_REMOVE: 25,\r\n    REMOVE_ITEM: 35,\r\n    REMOVE_UNDER: 150\r\n  };\r\n\r\nconst _getTouchesClientX = (ev) =>\r\n  (((ev || {}).touches || [])[0] || {}).clientX || 0;\r\nconst _getChangedTouches = (ev) =>\r\n  (((ev || {}).changedTouches || [])[0] || {}).clientX || 0;\r\n\r\nconst _dragStart = function(ev) {\r\n  ev.persist()\r\n  this.clientX = ev.clientX\r\n  this.dragStartWithDnDStyle(ev)\r\n  ev.dataTransfer.effectAllowed=\"move\"\r\n  ev.dataTransfer.dropEffect=\"move\"\r\n};\r\nconst _onTouchStart = function(ev) {\r\n  ev.persist()\r\n  const _clientX = _getTouchesClientX(ev);\r\n  if (_clientX) {\r\n    this._clientX = _clientX\r\n  }\r\n};\r\nconst _onTouchMove = function(ev) {\r\n  ev.persist()\r\n  const _clientX = _getTouchesClientX(ev);\r\n  if (_clientX\r\n     && Math.abs(this._clientX -  _clientX) > DELTA.MARK_REMOVE) {\r\n    this.dragStartWithDnDStyle(ev)\r\n  }\r\n};\r\n\r\nconst _dragEnd = function(ev) {\r\n  ev.preventDefault()\r\n  ev.persist()\r\n  this.dragEndWithDnDStyle()\r\n  const _deltaX = Math.abs(this.clientX - ev.clientX)\r\n      , { item, onRemoveUnder } = this.props;\r\n  if (_deltaX > DELTA.REMOVE_UNDER) {\r\n    onRemoveUnder(item)\r\n  } else if (_deltaX > DELTA.REMOVE_ITEM){\r\n    this._handleClose()\r\n  }\r\n};\r\nconst _onTouchEnd = function(ev) {\r\n  //ev.preventDefault()\r\n  ev.persist()\r\n  this.dragEndWithDnDStyle()\r\n  const _clientX = _getChangedTouches(ev);\r\n  if (_clientX) {\r\n    const _deltaX = Math.abs(this._clientX - _clientX)\r\n        , { item, onRemoveUnder } = this.props;\r\n    if (_deltaX > DELTA.REMOVE_UNDER) {\r\n      onRemoveUnder(item)\r\n    } else if (_deltaX > DELTA.REMOVE_ITEM){\r\n      this._handleClose()\r\n    }\r\n  }\r\n};\r\nconst _preventDefault = function(ev) {\r\n  ev.preventDefault()\r\n};\r\n\r\nconst _crDnDHandlers = function(){\r\n  return HAS_TOUCH\r\n   ? {\r\n      onTouchStart: this._onTouchStart.bind(this),\r\n      onTouchMove: this._onTouchMove.bind(this),\r\n      onTouchEnd: this._onTouchEnd.bind(this)\r\n     }\r\n   : {\r\n      draggable: true,\r\n      onDragStart: this._dragStart.bind(this),\r\n      onDragEnd: this._dragEnd.bind(this),\r\n      onDrop: this._preventDefault,\r\n      onDragOver: this._preventDefault,\r\n      onDragEnter: this._preventDefault,\r\n      onDragLeave: this._preventDefault\r\n    };\r\n};\r\n\r\n\r\nconst withDnD = (target) => {\r\n  withDnDStyle(target)\r\n  Object.assign(target.prototype, {\r\n     _dragStart,\r\n     _onTouchStart,\r\n     _onTouchMove,\r\n     _dragEnd,\r\n     _onTouchEnd,\r\n     _preventDefault,\r\n     _crDnDHandlers\r\n  })\r\n};\r\n\r\n\r\nexport default withDnD\r\n"],"file":"withDnD.js"}